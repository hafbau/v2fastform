# Requirements: Chat-First UX with Anonymous Auth Gating

*Generated from conversation on 2026-01-07*

## Objective
Refactor the app/chat creation flow to be chat-first: users start typing immediately, and app/chat creation happens implicitly from their first message. Anonymous users see the chat input but are gated with an auth modal when they try to send.

## Core Requirements

### Must Have (High Priority)

#### `/apps` Page Refactor
- [HIGH] Chat input component at the top of the page
- [HIGH] "Your apps" grid below the chat input (only renders if user has apps - no empty state)
- [HIGH] No "New App" button or form - apps are created implicitly
- [HIGH] When user sends a message: create app (name from input text) → create chat → redirect to `/apps/:appId/chats/:chatId`

#### `/apps/:appId/chats` Page Refactor
- [HIGH] Chat input component at the top
- [HIGH] "Chats" list below (for current appId)
- [HIGH] No "New Chat" CTA
- [HIGH] Delete `/apps/:appId/chats/new` page entirely
- [HIGH] When user sends a message: create chat under current appId → redirect to `/apps/:appId/chats/:chatId`

#### Anonymous User Flow
- [HIGH] On `/apps`, show only the chat input (no "Your apps" section)
- [HIGH] Don't fetch apps list if no user session
- [HIGH] On send → show auth modal ("Sign up or sign in to continue")
- [HIGH] After auth completes → create app + chat from preserved message → redirect to chat page

### Should Have (Medium Priority)
- [MEDIUM] Allow users to rename apps later (since name is auto-generated from first message)
- [MEDIUM] Message and attachments preserved across auth flow (already handled by sessionStorage in ChatInput)

## Technical Constraints
- **Existing Component:** Use existing `ChatInput` component from `components/chat/chat-input.tsx`
- **SessionStorage:** ChatInput already persists message/attachments to sessionStorage - handles message preservation across auth
- **Architecture:** Shared `ChatInput` component with different page shells (Option C discussed)
  - Authed page: ChatInput + apps grid / chats list
  - Unauthed page: ChatInput only (can add marketing later)
  - Prevents drift on core interaction while allowing flexibility

## User Context
**Target Users:**
- Anonymous visitors exploring the product
- Authenticated users creating and managing apps/chats

**Primary Use Case:**
- Reduce friction to first interaction
- Let users experience the product before requiring signup
- Streamlined app/chat creation without explicit forms

**User Flow (Anonymous):**
1. Land on `/apps`
2. See chat input only
3. Type message, hit send
4. Auth modal appears
5. Complete signup/login
6. App + chat created with their message
7. Redirected to chat page

**User Flow (Authenticated):**
1. On `/apps`: type message → app created → chat created → redirected
2. On `/apps/:appId/chats`: type message → chat created → redirected

## Edge Cases & Considerations
- App name generation from input text - need to handle long messages (truncate?)
- What if user types very short message for app name? (e.g., "hi")
- Auth modal design and UX (not specified in detail)

## Success Criteria
How we know this is complete and working:
- Anonymous users can see and type in chat input on `/apps`
- Anonymous users see auth modal on send (not 401 errors)
- Authenticated users can create apps implicitly by sending first message
- Apps are named from input text
- `/apps/:appId/chats/new` page is removed
- No "New App" or "New Chat" buttons anywhere
- Message is preserved after auth flow completes

## Next Steps
1. Review this PRD for accuracy and completeness
2. If anything is missing or unclear, continue the conversation
3. When ready, run `/clavix:plan` to generate implementation tasks

---
*This PRD was generated by Clavix from conversational requirements gathering.*
